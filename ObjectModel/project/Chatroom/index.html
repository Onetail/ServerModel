<!DOCTYPE html>
<html>
<head>
	<title>過著</title>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="assets/css/index.css">
	<link rel="stylesheet" type="text/css" href="assets/css/hint.css">
	<!-- <script src="/socket.io/socket.io.js"></script> -->
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>

	
	<!-- TODO: index's feature -->
	<script src="./indexFeature.js"></script>
</head>
<body onload="Main_Action" >
		<div class='loginbg bg-blur'  style="display:none" ></div>   
		<div class='loginpage' style="display:none" > 
			<div style='width:100%;height:10%;position:absolute;left:0;top:0;font-size:60px;'><i class="fa fa-times login_disappear" style='color:#258ac9;float:right;margin:5%;cursor:pointer;'aria-hidden="true"></i></div>
			<form action = '/test/login' method='POST' class='loginstyle'>
			<div style='width:100%;color:#258AC9;font-size:40px;text-align:center;margin-top:-10%;'>管理者登入</div>
			<div style='width:100%;display:flex;align-items:center;justify-content:center;flex-direction: column;margin-top:5%;'>
			<input type='text' name ='username' placeholder="帳號" class='logintext'>
			<input type='password' name = 'password' placeholder="密碼" class='logintext'>
			<div class='loginerror' style='color:red;display:none;'>登入失敗：請再次確認帳號密碼</div>
			</div>
			<input type='submit' value='確認' class='login_ctrl_btn'>
			
		</form>
		</div>
</body>
</html>

<script type="text/javascript">
	var Array_ul_Name = ["意見徵求","特殊功能","存檔保底","關於作者"];
	var User_Number = 0
	Main_Action = new function()
	{
		// __init__
		init_Build();


	};
	function init_Build()
	{
		// hidden
		var left_hidden = document.createElement("hidden");
		var right_hidden = document.createElement("hidden");

		// build frame 
		var title_frame = document.createElement('div');
		var top_frame = document.createElement("div");
		var left_frame = document.createElement("span")
		var center_frame = document.createElement("span");
		var right_frame = document.createElement("span");
		var bottom_frame = document.createElement("div");

		// hidden set id
		left_hidden.id="left_hidden";
		right_hidden.id="right_hidden";

		// frame set id
		title_frame.id="title_frame";
		top_frame.id = "top_frame";
		left_frame.id = "left_frame";
		center_frame.id = "center_frame";
		right_frame.id = "right_frame";
		bottom_frame.id = "bottom_frame";

		// append body
		document.body.appendChild(left_hidden);
		document.body.appendChild(right_hidden);
		document.body.appendChild(title_frame);
		document.body.appendChild(top_frame);
		document.body.appendChild(left_frame);
		document.body.appendChild(center_frame);
		document.body.appendChild(right_frame);
		document.body.appendChild(bottom_frame);

		// UI
		UI_Control();
		// Socket 2018/05/30 new 
		UserNumberInChatroom()

	}
	function UserNumberInChatroom(){
		// TODO: get this chatroom user number 
		setInterval(()=>{
			$.post("./UserCount",(data)=>
			{
				User_Number = data	
				document.getElementById('word_m').innerHTML=`當前連線人數:    ${User_Number} 人`;
			})},1000)

		
	}
	function Left_Feature_HTML(){
		var ui = ""
		for(let i in Array_ul_Name){
			ui += `<a class='Button_outer' id=${Array_ul_Name[i]}>`+Array_ul_Name[i]+"</a><br>"
			$(document).ready(function() {
				$(`#${Array_ul_Name[i]}`).click(()=>{
					UiOnClickListener(i)
				})
			})
		}
		
		
		// for(let i , max = Array_ul_Name.length ; i < max ; i ++)ui += `<a href='#' class='Button_outer' id=${i}>`+Array_ul_Name[i]+"</a><br>"
		
		return ui		
	}
	function UI_Control()
	{
		//LEFT HIDDEN
		document.getElementById("left_hidden").innerHTML="<span id='left_hidden'><img id='left_hidden_img' src='images/hidden.png' >"+
		"<ul id='hidden_left_ui'>"+Left_Feature_HTML()+"</ul></span>"
		
		
		// RIGHT HIDDEN
		document.getElementById("right_hidden").innerHTML="<span id='right_hidden'><br><img id='right_hidden_img'  src='images/hidden2.png'><br></span>"

		// TITLE
		document.getElementById('title_frame').innerHTML="<p id='title_font' class='hint--bottom hint--info' data-hint='WMES歡迎您'>通訊WMES</p>";

		// TOP
		document.getElementById("top_frame").innerHTML="<img id='top_img' src='images/img1.png' style='display:block;margin:auto;'><br>";

		// LEFT
		// document.getElementById('left_frame').innerHTML="";

		// CENTER
		document.getElementById('center_frame').innerHTML=`<p id='word_m'>當前連線人數:    ${User_Number} 人</p>`;

		// // RIGHT

		// document.getElementById('right_frame').innerHTML="";

		// BOTTOM

		document.getElementById('bottom_frame').innerHTML="<a href='#' id='button_action' class='button_enter' onclick='Button_Action()'><sp id='sp_action'>進入聊天</sp></a>";


		// EVENT FUNCTION
		Control_EVENT();
	}
	function Control_EVENT()
	{
		// EVENT
		
		//		TOP
		top_img.onmouseover = function()
		{
			document.getElementById('top_img').src="images/img2.png";
		};
		top_img.onmouseout = function()
		{
			document.getElementById('top_img').src="images/img1.png";
		};


		//		LEFT
		left_hidden_img.onmouseover = function()
		{
			hidden_left_ui.style.marginLeft='0%';
			hidden_left_ui.style.transition='1.5s';
		
		};
		left_hidden_img.onmouseout = function()
		{
			hidden_left_ui.style.marginLeft='-150%';
			hidden_left_ui.style.transition='1.5s';
		
		};
		hidden_left_ui.onmouseover = function()
		{
			hidden_left_ui.style.marginLeft='0%';
			hidden_left_ui.style.transition='1.5s';

		};
		hidden_left_ui.onmouseout = function()
		{
			hidden_left_ui.style.marginLeft='-150%';
			hidden_left_ui.style.transition='1.5s';	
		};

		//		RIGHT
		right_hidden_img.onmouseover = function()
		{
			right_hidden_img.style.webkitAnimationPlayState = "paused";
			right_hidden_img.style.AnimationPlayState = "paused";
		};
		right_hidden_img.onmouseout = function()
		{
			right_hidden_img.style.webkitAnimationPlayState = "running";
			right_hidden_img.style.AnimationPlayState = "running";
		};

		// 		BOTTOM
		// button_action.onmouseover = function()
		// {
		// 	// sp_action.style.color='#ffff00';
		// 	sp_action.style.display="none";
		// 	sp_action.style.marginLeft='-50%';
		// 	sp_action.style.transition='1.5s';
		// };
		
	}
	//		button event function
	function Button_Action()
	{
		var action = location.href.split("/")
		delete action[action.length-1]
		action = action.join("/")
		console.log(action)
		location.assign(action+"chatroom.html");

	}
</script>

